var Lion = (function (exports) {
  'use strict';

  const renderWithCanvas = (layers) => {
      layers.forEach((layer) => {
          const ctx = layer._self.getContext('2d');
          layer.children.forEach((child) => {
              if (child.nodeType === 'Block') {
                  renderBlock(ctx, child);
              }
          });
      });
  };
  const renderBlock = (ctx, block) => {
      ctx.fillStyle = block.attributes.backgroundColor;
      ctx.fillRect(block.x, block.y, block.width, block.height);
  };

  class App {
      constructor(options) {
          this.root = null;
          this.layers = [];
          this._layersSortedByIndex = [];
          this.resolution = 1;
          this.nodeType = 'APP';
          this.resolution = options && options.resolution ? options.resolution : 1;
      }
      mount(element) {
          this.root = element;
      }
      sortByzIndex(layers) {
          return layers.sort((a, b) => {
              return a.attributes.zIndex - b.attributes.zIndex;
          });
      }
      render() {
          this._layersSortedByIndex = this.sortByzIndex(this.layers);
          renderWithCanvas(this._layersSortedByIndex);
      }
      append(layer) {
          if (this.root === null) {
              this.root = document.createElement('div');
              this.root.id = 'LionRoot';
              this.root.style.width = '100vw';
              this.root.style.height = '100vh';
              document.body.append(this.root);
          }
          const width = +getComputedStyle(this.root).width.match(/[0-9]*/) * this.resolution;
          const height = +getComputedStyle(this.root).height.match(/[0-9]*/) * this.resolution;
          layer._self.width = width;
          layer._self.height = height;
          this.root.append(layer._self);
          this.layers.push(layer);
      }
  }

  let _BaseNodeId = 0;
  class BaseNode {
      constructor() {
          this.x = 0;
          this.y = 0;
          this.width = 0;
          this.height = 0;
          this.parent = null;
          this.children = [];
          this.nodeType = 'Base';
          this.attributes = {
              zIndex: 0,
              borderRadius: 0,
              backgroundColor: '#000000',
              padding: [0, 0, 0, 0],
              margin: [0, 0, 0, 0],
          };
          Object.defineProperty(this, 'id', { value: _BaseNodeId++ });
      }
      copy() { }
      addEventListener() { }
      removeEventListener() { }
      removeAllListeners() { }
      attr() { }
      removeAttribute() { }
      append(child) {
          if (child instanceof BaseNode) {
              child.parent = this;
              this.children.push(child);
          }
          else {
              throw new Error('only Lion node can be appended.');
          }
      }
  }

  class Block extends BaseNode {
      constructor(options) {
          super();
          this.nodeType = 'Block';
          this.x = options.x;
          this.y = options.y;
          this.width = options.width;
          this.height = options.height;
      }
  }

  class Layer extends BaseNode {
      constructor(options) {
          super();
          this.nodeType = 'layer';
          this.attributes.zIndex = options.zIndex !== undefined ? options.zIndex : 1;
          this.attributes.backgroundColor =
              options.backgroundColor !== undefined ? options.backgroundColor : '#000000';
          this.init();
      }
      init() {
          const canvas = document.createElement('canvas');
          canvas.style.position = 'absolute';
          canvas.style.width = `100%`;
          canvas.style.height = `100%`;
          canvas.style.backgroundColor = this.attributes.backgroundColor;
          canvas.style.zIndex = `${this.attributes.zIndex}`;
          canvas.width = this.width;
          canvas.height = this.height;
          this._self = canvas;
      }
  }

  class Sprite extends BaseNode {
      constructor(options) {
          super();
      }
  }

  exports.App = App;
  exports.BaseNode = BaseNode;
  exports.Block = Block;
  exports.Layer = Layer;
  exports.Sprite = Sprite;

  Object.defineProperty(exports, '__esModule', { value: true });

  return exports;

}({}));
